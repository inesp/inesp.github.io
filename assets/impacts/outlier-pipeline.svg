<svg viewBox="0 0 480 340" xmlns="http://www.w3.org/2000/svg" font-family="system-ui, -apple-system, sans-serif">
  <!-- Background -->
  <rect width="480" height="480" fill="#fff"/>

  <!-- Arrowhead marker definition -->
  <defs>
    <marker id="arrow" markerWidth="4" markerHeight="4" refX="3" refY="2" orient="auto">
      <polygon points="0,0 4,2 0,4" fill="#212529"/>
    </marker>
    <marker id="arrow-thick" markerWidth="4" markerHeight="4" refX="3" refY="2" orient="auto">
      <polygon points="0,0 4,2 0,4" fill="#212529"/>
    </marker>
  </defs>

  <!-- RAW DATA -->
  <rect x="170" y="10" width="140" height="24" rx="4" fill="#fd456f" stroke="#ff0040" stroke-width="1.5"/>
  <text x="240" y="25" text-anchor="middle" font-size="10" fill="#fff" font-weight="bold">Raw Data</text>

  <!-- Arrow down -->
  <line x1="240" y1="34" x2="240" y2="55" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Decision 1: Pervasive? -->
  <polygon points="240,60 330,95 240,130 150,95" fill="#fff" stroke="#212529" stroke-width="1.5"/>
  <text x="240" y="92" text-anchor="middle" font-size="9" fill="#212529">Is median pervasive?</text>
  <text x="240" y="103" text-anchor="middle" font-size="8" fill="#6c757d">(≥95% at median)</text>

  <!-- NO branch (left) - Path A: to KDE -->
  <line x1="150" y1="95" x2="70" y2="95" stroke="#212529" stroke-width="2.5"/>
  <line x1="70" y1="95" x2="70" y2="155" stroke="#212529" stroke-width="2.5" marker-end="url(#arrow-thick)"/>
  <text x="115" y="88" font-size="9" fill="#212529" font-weight="bold">NO</text>
  <text x="115" y="108" font-size="8" text-anchor="middle" fill="#6c757d">Most common path.</text>

  <!-- KDE box -->
  <rect x="20" y="160" width="100" height="40" rx="4" fill="#ffed50" stroke="#e7d749" stroke-width="1.5"/>
  <text x="70" y="176" text-anchor="middle" font-size="10" fill="#212529" font-weight="bold">KDE</text>
  <text x="70" y="190" text-anchor="middle" font-size="8" fill="#6c757d">major outliers</text>

  <!-- Arrow from KDE down then right to DBSCAN -->
  <line x1="70" y1="200" x2="70" y2="260" stroke="#212529" stroke-width="2.5"/>
  <line x1="70" y1="260" x2="165" y2="260" stroke="#212529" stroke-width="2.5" marker-end="url(#arrow-thick)"/>

  <!-- YES branch - down to Decision 2 -->
  <line x1="240" y1="130" x2="240" y2="140" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="250" y="138" font-size="9" fill="#212529" font-weight="bold">YES</text>

  <!-- Decision 2: Super pervasive? -->
  <polygon points="240,145 310,175 240,205 170,175" fill="#fff" stroke="#212529" stroke-width="1.5"/>
  <text x="240" y="178" text-anchor="middle" font-size="8" fill="#212529">Is data extremely uniform?</text>
  <text x="240" y="190" text-anchor="middle" font-size="8" fill="#6c757d">(std ≤ 0.2)</text>

  <!-- Path C: YES super pervasive - straight down to DBSCAN -->
  <line x1="240" y1="205" x2="240" y2="235" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="245" y="223" font-size="8" fill="#212529">YES</text>

  <!-- DBSCAN box (now below Diamond 2) -->
  <rect x="170" y="240" width="140" height="40" rx="4" fill="#ffed50" stroke="#e7d749" stroke-width="1.5"/>
  <text x="238" y="256" text-anchor="middle" font-size="10" fill="#212529" font-weight="bold">DBSCAN</text>
  <text x="238" y="270" text-anchor="middle" font-size="8" fill="#6c757d">minor outliers</text>

  <!-- Path B: NO - right to Cutoff -->
  <line x1="310" y1="175" x2="345" y2="175" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="318" y="168" font-size="8" fill="#212529">NO</text>

  <!-- Cutoff box (now on right) -->
  <rect x="350" y="160" width="100" height="40" rx="4" fill="#ffed50" stroke="#e7d749" stroke-width="1.5"/>
  <text x="400" y="176" text-anchor="middle" font-size="10" fill="#212529" font-weight="bold">Cutoff</text>
  <text x="400" y="190" text-anchor="middle" font-size="8" fill="#6c757d">percentile jumps</text>

  <!-- Arrow from Cutoff to Confident decision -->
  <line x1="400" y1="200" x2="400" y2="225" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Decision 3: Confident? (now on right) -->
  <polygon points="400,230 450,255 400,280 350,255" fill="#fff" stroke="#212529" stroke-width="1.5"/>
  <text x="400" y="258" text-anchor="middle" font-size="8" fill="#212529">Confident?</text>

  <!-- YES confident - down to clean data -->
  <line x1="400" y1="280" x2="400" y2="318" stroke="#212529" stroke-width="1.5"/>
  <line x1="400" y1="318" x2="315" y2="318" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="405" y="300" font-size="8" fill="#212529">YES</text>

  <!-- NO confident - left to DBSCAN -->
  <line x1="350" y1="255" x2="315" y2="255" stroke="#212529" stroke-width="1.5" marker-end="url(#arrow)"/>
  <text x="335" y="250" font-size="8" fill="#212529">NO</text>

  <!-- Arrow down from DBSCAN to clean data -->
  <line x1="238" y1="280" x2="238" y2="300" stroke="#212529" stroke-width="2.5" marker-end="url(#arrow)"/>

  <!-- CLEAN DATA -->
  <rect x="170" y="305" width="140" height="24" rx="4" fill="#28a745" stroke="#1e7e34" stroke-width="1.5"/>
  <text x="238" y="321" text-anchor="middle" font-size="10" fill="#fff" font-weight="bold">Clean Data</text>
</svg>
